(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{430:function(e,t,n){"use strict";n.r(t);n(26),n(19),n(20),n(37),n(25),n(38);var r=n(11),l=(n(263),n(9),n(62),n(27)),o=n(63),d=n.n(o),c=n(266);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var h={name:"edit-media",layout:"edit",middleware:"auth",components:{draggable:n.n(c).a},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(l.b)(["isAuthenticated","loggedInUser"])),created:function(){},mounted:function(){this.getLiens()},data:function(){return{url_server:this.$store.state.url_server,flexIsFile:"",source:this.lien_source,id_parent:this.lien_id_parent,id_lien:0,isNew_lien:!1,liens:[],lien:"",isShowLoadingLiens:!0,isShowNoResultLiens:!1,titre:"",url:""}},props:{lien_source:String,lien_id_parent:Number},methods:{getLiens:function(){var e=this;this.isShowNoResultLiens=!1,d.a.get(this.url_server+"/getLiens?id_intervenant="+this.id_parent).then((function(t){e.isShowLoadingLiens=!1,e.liens=t.data.liste,0==e.liens.length&&(e.isShowNoResultLiens=!0)})).catch((function(e){displayErreur("liens loading error")}))},getLien:function(){var e=this;d.a.get(this.url_server+"/getLien?id_lien="+this.id_lien).then((function(t){e.lien=t.data.liste,void 0!==e.lien.titre?(e.titre=e.lien.titre,e.url=e.lien.url):(e.titre="",e.url="")})).catch((function(t){e.titre="",e.url="",e.id_lien=0,displayErreur("lien loading error")}))},delLien:function(){var e=this;d.a.get(this.url_server+"/delLien?id_lien="+this.id_lien).then((function(t){e.displayLien(),e.getLiens()})).catch((function(t){e.id_lien=0,displayErreur("lien deleting error")}))},submitLienForm:function(){var e=this;clearRequiredModal(),this.hideErreur(),this.isNew_lien=!1,0==this.id_lien&&(this.isNew_lien=!0);var data={id_lien:this.id_lien,id_intervenant:this.id_parent,titre:this.titre,url:this.url,isNew:this.isNew_lien},t=document.querySelectorAll(".modalZone .required_field");[].forEach.call(t,(function(e){""==e.value&&e.classList.add("required")})),""==this.titre&&document.getElementById("titre_lien").classList.add("required"),""==this.url&&document.getElementById("url_lien").classList.add("required"),checkRequiredModal()?displayErreur("Les champs en rouges sont requis"):(disabledActionsModal(),d.a.post(this.url_server+"/addLien",data).then((function(t){e.id_lien=t.data.id_lien,e.isShowNoResultLien=!1,e.displayLien(),e.liens=new Array,e.getLiens()})).catch((function(e){enabledActionsModal(),displayErreur("Error adding lien : "+e)})))},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},displayLien:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=document.querySelectorAll("#defaultModal")[0];t.classList.contains("hidden")?(t.classList.remove("hidden"),t.focus(),this.id_lien=e,0!=this.id_lien?this.getLien():(this.titre="",this.url="",this.id_lien=0)):(this.id_lien=0,this.titre="",this.url="",t.classList.add("hidden"),this.initForm())},hideErreur:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){hideErreur()})),initForm:function(e){void 0!==e?e.target.classList.contains("required")&&e.target.classList.remove("required"):clearRequiredModal(),enabledActionsModal(),hideErreur()},onEndPosition:function(){var data={id_lien:this.id_lien,list:this.liens};d.a.post(this.url_server+"/updateLienPosition",data).then((function(e){})).catch((function(e){return displayErreur("error updating liens")}))}}},f=h,m=n(10),component=Object(m.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"form-bloc form-bloc-list mt-6"},[n("div",{staticClass:"col w-full"},[n("div",{staticClass:"col-content"},[n("label",{staticClass:"mb-3 border-b border-mainColor cursor-pointer",attrs:{for:"AddFile",id:"LAddFile"},on:{click:function(t){e.displayLien(0),e.hideErreur()}}},[n("div",{staticClass:"pb-2"},[e._v("Liens")]),e._v(" "),n("div",{staticClass:"flex-1 text-right flex justify-end add highlight"},[n("svg",{staticClass:"w-5 h-5",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[n("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"}})])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowLoadingLiens,expression:"isShowLoadingLiens"}],staticClass:"loading"},[e._v("Chargement...")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowNoResultLiens,expression:"isShowNoResultLiens"}],staticClass:"loading"},[e._v("aucun lien.")]),e._v(" "),n("draggable",{attrs:{list:e.liens,tag:"div"},on:{end:e.onEndPosition}},e._l(e.liens,(function(t,r){return n("div",{staticClass:"relative cursor-pointer"},[n("div",{staticClass:"w-full mb-3 flex items-start justify-between hover:text-activeColor",on:{click:function(n){e.displayLien(t.id_lien),e.hideErreur()}}},[n("div",[e._v(e._s(t.titre))])])])})),0)],1)])]),e._v(" "),n("div",{staticClass:"modalZone hidden overflow-y-auto overflow-x-hidden bg-mainBg/50 flex fixed right-0 left-0 top-4 z-50 justify-center items-center md:h-full md:inset-0",attrs:{id:"defaultModal",tabindex:"1"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.displayLien(0)}}},[n("div",{staticClass:"relative px-6 w-full max-w-2xl h-full md:h-auto"},[n("div",{staticClass:"relative bg-mainBg p-6 border border-activeColor"},[n("div",{staticClass:"flex justify-between items-start border-b border-mainColor"},[n("h1",[e._v("Lien")]),e._v(" "),n("div",{staticClass:"bg-transparent ml-auto inline-flex items-center highlight",attrs:{"data-modal-toggle":"defaultModal"}},[n("svg",{staticClass:"big cursor-pointer",attrs:{fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){return e.displayLien()}}},[n("path",{attrs:{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"}})])])]),e._v(" "),n("div",[n("div",{staticClass:"form-container w-full border-0 p-0"},[n("form",{attrs:{method:"post",autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.submitLienForm.apply(null,arguments)}}},[n("div",{staticClass:"form-bloc mt-9"},[n("div",{staticClass:"col w-full"},[n("div",{staticClass:"col-content"},[n("label",{attrs:{for:"titre",id:"Ltitre"}},[e._v("Libell√©")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.titre,expression:"titre"}],attrs:{type:"text",name:"titre",id:"titre_lien"},domProps:{value:e.titre},on:{focus:e.initForm,input:function(t){t.target.composing||(e.titre=t.target.value)}}})])])]),e._v(" "),n("div",{staticClass:"form-bloc"},[n("div",{staticClass:"col w-full"},[n("div",{staticClass:"col-content"},[n("label",{attrs:{for:"url",id:"Lurl"}},[e._v("Url")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.url,expression:"url"}],attrs:{type:"text",name:"url",id:"url_lien"},domProps:{value:e.url},on:{focus:e.initForm,input:function(t){t.target.composing||(e.url=t.target.value)}}})])])]),e._v(" "),n("div",{staticClass:"form-action"},[n("div",[n("button",{attrs:{type:"button"},on:{click:function(t){return e.displayLien()}}},[e._v("Annuler")])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.id_lien,expression:"id_lien != 0"}]},[n("button",{staticClass:"bt-delete",attrs:{type:"button"},on:{click:function(t){return e.delLien()}}},[e._v("Supprimer")])]),e._v(" "),e._m(0)])])])])])])])])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{attrs:{type:"submit"}},[e._v("Enregistrer")])])}],!1,null,null,null);t.default=component.exports}}]);