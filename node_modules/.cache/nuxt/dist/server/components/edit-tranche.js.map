{"version":3,"file":"components/edit-tranche.js","sources":["webpack:///./components/editTranche.vue?8f83","webpack:///./components/editTranche.vue","webpack:///./components/editTranche.vue?686d","webpack:///./components/editTranche.vue?13ea"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._ssrNode(\"<div class=\\\"form-bloc form-bloc-list mt-6\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col w-full\\\">\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-content\\\">\",\"</div>\",[_vm._ssrNode(\"<label for=\\\"AddFile\\\" id=\\\"LAddFile\\\" class=\\\"mb-3 border-b border-mainColor cursor-pointer\\\"><div class=\\\"pb-2\\\">Résumés</div> <div class=\\\"flex-1 text-right flex justify-end add highlight\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" fill=\\\"none\\\" viewBox=\\\"0 0 24 24\\\" stroke=\\\"currentColor\\\" class=\\\"w-5 h-5\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M12 4v16m8-8H4\\\"></path></svg></div></label> <div class=\\\"loading\\\"\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowLoadingTranches) ? '' : 'none' }))+\">Chargement...</div> <div class=\\\"loading\\\"\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowNoResultTranches) ? '' : 'none' }))+\">aucun résumé.</div> \"),_c('draggable',{attrs:{\"list\":_vm.tranches,\"tag\":\"div\"},on:{\"end\":_vm.onEndPosition}},_vm._l((_vm.tranches),function(tranche,indexTranche){return _c('div',{staticClass:\"relative cursor-pointer\"},[_c('div',{staticClass:\"w-full mb-3 flex items-start justify-between hover:text-activeColor\",on:{\"click\":function($event){_vm.displayTranche(tranche.id_tranche);_vm.hideErreur();}}},[_c('div',[_vm._v(_vm._s(tranche.titre))]),_vm._v(\" \"),_c('div',{staticClass:\"text-right pl-3\"},[_vm._v(_vm._s(_vm.formatResume(tranche.tps_debut,tranche.tps_fin)))])])])}),0)],2)])]),_vm._ssrNode(\" <div id=\\\"defaultModal\\\" tabindex=\\\"1\\\" class=\\\"modalZone hidden overflow-y-auto overflow-x-hidden bg-mainBg/50 flex fixed right-0 left-0 top-4 z-50 justify-center items-center md:h-full md:inset-0\\\"><div class=\\\"relative px-6 w-full max-w-2xl h-full md:h-auto\\\"><div class=\\\"relative bg-mainBg p-6 border border-activeColor\\\"><div class=\\\"flex justify-between items-start border-b border-mainColor\\\"><h1>Résumé</h1> <div data-modal-toggle=\\\"defaultModal\\\" class=\\\"bg-transparent ml-auto inline-flex items-center highlight\\\"><svg fill=\\\"currentColor\\\" viewBox=\\\"0 0 20 20\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"big cursor-pointer\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\\\" clip-rule=\\\"evenodd\\\"></path></svg></div></div> <div><div class=\\\"form-container w-full border-0 p-0\\\"><form method=\\\"post\\\" autocomplete=\\\"off\\\"><div class=\\\"form-bloc mt-9\\\"><div class=\\\"col w-full\\\"><div class=\\\"col-content\\\"><label for=\\\"titre\\\" id=\\\"Ltitre\\\">Titre</label> <input type=\\\"text\\\" name=\\\"titre\\\" id=\\\"titre_resume\\\"\"+(_vm._ssrAttr(\"value\",(_vm.titre)))+\"></div></div></div> <div class=\\\"form-bloc\\\"><div class=\\\"col w-full\\\"><div class=\\\"col-content\\\"><label for=\\\"tps_debut\\\" id=\\\"Ltps_debut\\\">Début</label> <div class=\\\"relative mt-1\\\"><div class=\\\"flex absolute inset-y-0 right-0 items-center pointer-events-none text-activeColor pr-3\\\">sec</div> <input type=\\\"text\\\" name=\\\"tps_debut\\\" id=\\\"tps_debut\\\"\"+(_vm._ssrAttr(\"value\",(_vm.tps_debut)))+\"></div></div></div></div> <div class=\\\"form-bloc\\\"><div class=\\\"col w-full\\\"><div class=\\\"col-content\\\"><label for=\\\"tps_fin\\\" id=\\\"Ltps_fin\\\">Fin</label> <div class=\\\"relative mt-1\\\"><div class=\\\"flex absolute inset-y-0 right-0 items-center pointer-events-none text-activeColor pr-3\\\">sec</div> <input type=\\\"text\\\" name=\\\"tps_fin\\\" id=\\\"tps_fin\\\"\"+(_vm._ssrAttr(\"value\",(_vm.tps_fin)))+\"></div></div></div></div> <div class=\\\"form-action\\\"><div><button type=\\\"button\\\">Annuler</button></div> <div\"+(_vm._ssrStyle(null,null, { display: (_vm.id_tranche != 0) ? '' : 'none' }))+\"><button type=\\\"button\\\" class=\\\"bt-delete\\\">Supprimer</button></div> <div><button type=\\\"submit\\\">Enregistrer</button></div></div></form></div></div></div></div></div>\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from 'vuex';\nimport axios from 'axios';\nimport draggable from 'vuedraggable'\n\nexport default {\n  name: 'edit-media',\n  layout: 'edit',\n  middleware: 'auth',\n  components: {\n        draggable\n    }\n  ,\n  computed: {\n    ...mapGetters(['isAuthenticated', 'loggedInUser']),\n  },\n  created() {\n  }\n  ,\n  mounted() {\n\t  this.getTranches();\n\t  \n\t  \n  },\n  data() {\n    return {\n\t  url_server:this.$store.state.url_server,\n\t  flexIsFile:'',\n\t  source:this.tranche_source,\n\t  id_parent : this.tranche_id_parent,\n\t  id_tranche: 0,\n\t  isNew_tranche:false,\n\t  tranches:[],\n\t  tranche:'',\n\t  isShowLoadingTranches:true,\n\t  isShowNoResultTranches:false,\n\t  titre:'',\n\t  tps_debut:0,\n\t  tps_fin:0,\n    }\n  },\n  props: {\n  \ttranche_source: String,\n    tranche_id_parent: Number,\n  },\n  methods: {\n     getTranches: function()\n\t {\n\t   this.isShowNoResultTranches = false;\n       axios.get(this.url_server + \"/getTranches?id_interview=\" + this.id_parent)\n       .then(response => {\n\t       console.log(\"getTranches\")\n\t       this.isShowLoadingTranches = false;\n\t       this.tranches = response.data.liste;\n\t       console.log(\"getTranches : \" + this.tranches.length)\n\t       if (this.tranches.length == 0) this.isShowNoResultTranches = true;\n\t   })\n\t   .catch(error => {\n\t\t   displayErreur('tranches loading error')\n      })\n    }\n    ,\n    getTranche: function()\n\t {\n       axios.get(this.url_server + \"/getTranche?id_tranche=\" + this.id_tranche)\n       .then(response => {\n\t       this.tranche = response.data.liste;\n\t\t   if (typeof this.tranche.titre !== 'undefined') {\n\t\t       this.titre = this.tranche.titre;\n\t\t       this.tps_debut = this.tranche.tps_debut.toFixed(2);\n\t\t       this.tps_fin = this.tranche.tps_fin.toFixed(2);\n\t\t    }\n\t\t    else {\n\t\t\t    this.tps_debut = 0;\n\t\t\t    this.tps_fin = 0;\n\t\t    }\n\t   })\n       .catch(error => {\n\t       this.tps_debut = 0;\n\t       this.tps_fin = 0;\n\t       this.id_tranche = 0;\n\t\t   displayErreur(\"tranche loading error\")\n      })\n    },\n    delTranche: function()\n\t {\n       axios.get(this.url_server + \"/delTranche?id_tranche=\" + this.id_tranche)\n       .then(response => {\n\t       this.displayTranche();\n\t\t   this.getTranches();\n\t   })\n       .catch(error => {\n\t       this.id_tranche = 0;\n\t\t   displayErreur(\"tranche deleting error\")\n      })\n    }\n    ,\n\tsubmitTrancheForm() {\n\t   var erreur = 'Les champs en rouges sont requis';\n\t   clearRequiredModal();\n\t   this.hideErreur();\n\t   \n\t   this.isNew_tranche = false;\n\t   if (this.id_tranche == 0) this.isNew_tranche = true;\n\n\t   let data = {\n\t\tid_tranche:this.id_tranche,\n\t\tid_interview: this.id_parent,\n\t\ttitre: this.titre,\n\t\ttps_debut: this.tps_debut,\n\t\ttps_fin: this.tps_fin,\n        isNew: this.isNew_tranche,\n      };\n\n      var elems = document.querySelectorAll(\".modalZone .required_field\");\n\t  [].forEach.call(elems, function(el) {\n\t\t    if ((el.value == '')) {\n\t\t\t   el.classList.add(\"required\");\n\t\t\t}\n\t\t});\n\t\t\n\t\tif (this.titre == '') {\n\t\t\t document.getElementById(\"titre_resume\").classList.add(\"required\");\n\t\t}\n\t\t\n\t\tif (this.tps_debut == '') this.tps_debut = 0;\n\t\tif (this.tps_debut == 0) {\n\t\t\t document.getElementById(\"tps_debut\").classList.add(\"required\");\n\t\t}\n\t\t\n\t\tif (this.tps_fin == '') this.tps_fin = 0;\n\t\tif (this.tps_fin == 0) {\n\t\t\t document.getElementById(\"tps_fin\").classList.add(\"required\");\n\t\t}\n\t\t\n\n\t\tif(checkRequiredModal()) {\n\t\t\tdisplayErreur(erreur);\n\t\t}\n\t\telse {\n\t\t\tdisabledActionsModal();\n\t\t\t  axios.post(this.url_server + \"/addTranche\", data)\n\t\t\t   .then(response => {\n\t\t\t\t   this.id_tranche = response.data.id_tranche;\n\t\t\t\t   this.isShowNoResultTranche = false;\n\t\t\t\t   this.displayTranche();\n\t\t\t\t   this.tranches = new Array();\n\t\t\t\t   this.getTranches();\n\t\t\t   })\n\t\t\t   .catch(error => {\n\t\t\t\t  enabledActionsModal();\n\t\t\t\t  displayErreur(\"Error adding tranche : \" + error)\n\t\t\t   })\n\t\t\t\n\t\t}\n       \n    }\n    ,\n    isNumber(n) {\n\t    return !isNaN(parseFloat(n)) && isFinite(n);\n\t}\n    ,\n    displayTranche: function(id_tranche = 0)\n    {\n\t    \n\t    var _element = document.querySelectorAll(\"#defaultModal\")[0]\n\t    \n\t    if (_element.classList.contains('hidden')) {\n\t\t    _element.classList.remove(\"hidden\");\n\t\t    _element.focus()\n\t\t    this.id_tranche = id_tranche;\n\t\t    if (this.id_tranche != 0) {\n\t\t\t\t\n\t\t\t\tthis.getTranche();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.titre = '';\n\t\t\t\tthis.tps_debut = 0;\n\t\t\t\tthis.tps_fin = 0;\n\t\t\t\tthis.id_tranche = 0;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.id_tranche = 0;\n\t\t\tthis.titre = '';\n\t\t\tthis.tps_debut = 0;\n\t\t\tthis.tps_fin = 0;\n\t\t\t_element.classList.add(\"hidden\");\n\t\t\tthis.initForm();\n\t\t}\n    }\n\t,\n\thideErreur: function()\n    {\n\t    hideErreur();\n    }\n    ,\n    initForm: function(event)\n    {\n\t   if (typeof event !== 'undefined') {\n\t\t\tif (event.target.classList.contains(\"required\")) event.target.classList.remove(\"required\");\n       }\n       else {\n\t       clearRequiredModal();\n       }\n\t   enabledActionsModal();\n\t   hideErreur();\n    }\n    ,\n\tonEndPosition()\n\t{\n\t\tlet data = {\n\t\t\tid_tranche: this.id_tranche,\n\t\t\tlist: this.tranches,\n\t      };\n\t\t axios.post(this.url_server + \"/updateTranchePosition\", data)\n\t       .then(response => {\n\t\t       \n\t\t   })\n\t       .catch(error => displayErreur(\"error updating tranches\"))\n\t}\n\t,\n\tformatResume(tps_debut,tps_fin)\n\t{\n\t\tvar val = parseFloat(tps_fin).toFixed(2) - parseFloat(tps_debut).toFixed(2);\n\t\treturn val.toFixed(2).toString().replace(\".\",\":\");\n\t}\n\t\n  }\n}\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./editTranche.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./editTranche.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./editTranche.vue?vue&type=template&id=97cd3eb8&\"\nimport script from \"./editTranche.vue?vue&type=script&lang=js&\"\nexport * from \"./editTranche.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"667f1bce\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AAIA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAeA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAFA;AAIA;AAKA;AACA;AACA;AAEA;AACA;AACA;AACA;AAtLA;AAxCA;;AC3GA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}