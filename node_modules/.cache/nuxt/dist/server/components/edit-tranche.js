exports.ids = [6];
exports.modules = {

/***/ 77:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@nuxt/components/dist/loader.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./components/editTranche.vue?vue&type=template&id=97cd3eb8&
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._ssrNode("<div class=\"form-bloc form-bloc-list mt-6\">","</div>",[_vm._ssrNode("<div class=\"col w-full\">","</div>",[_vm._ssrNode("<div class=\"col-content\">","</div>",[_vm._ssrNode("<label for=\"AddFile\" id=\"LAddFile\" class=\"mb-3 border-b border-mainColor cursor-pointer\"><div class=\"pb-2\">Résumés</div> <div class=\"flex-1 text-right flex justify-end add highlight\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" class=\"w-5 h-5\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 4v16m8-8H4\"></path></svg></div></label> <div class=\"loading\""+(_vm._ssrStyle(null,null, { display: (_vm.isShowLoadingTranches) ? '' : 'none' }))+">Chargement...</div> <div class=\"loading\""+(_vm._ssrStyle(null,null, { display: (_vm.isShowNoResultTranches) ? '' : 'none' }))+">aucun résumé.</div> "),_c('draggable',{attrs:{"list":_vm.tranches,"tag":"div"},on:{"end":_vm.onEndPosition}},_vm._l((_vm.tranches),function(tranche,indexTranche){return _c('div',{staticClass:"relative cursor-pointer"},[_c('div',{staticClass:"w-full mb-3 flex items-start justify-between hover:text-activeColor",on:{"click":function($event){_vm.displayTranche(tranche.id_tranche);_vm.hideErreur();}}},[_c('div',[_vm._v(_vm._s(tranche.titre))]),_vm._v(" "),_c('div',{staticClass:"text-right pl-3"},[_vm._v(_vm._s(_vm.formatResume(tranche.tps_debut,tranche.tps_fin)))])])])}),0)],2)])]),_vm._ssrNode(" <div id=\"defaultModal\" tabindex=\"1\" class=\"modalZone hidden overflow-y-auto overflow-x-hidden bg-mainBg/50 flex fixed right-0 left-0 top-4 z-50 justify-center items-center md:h-full md:inset-0\"><div class=\"relative px-6 w-full max-w-2xl h-full md:h-auto\"><div class=\"relative bg-mainBg p-6 border border-activeColor\"><div class=\"flex justify-between items-start border-b border-mainColor\"><h1>Résumé</h1> <div data-modal-toggle=\"defaultModal\" class=\"bg-transparent ml-auto inline-flex items-center highlight\"><svg fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\" class=\"big cursor-pointer\"><path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path></svg></div></div> <div><div class=\"form-container w-full border-0 p-0\"><form method=\"post\" autocomplete=\"off\"><div class=\"form-bloc mt-9\"><div class=\"col w-full\"><div class=\"col-content\"><label for=\"titre\" id=\"Ltitre\">Titre</label> <input type=\"text\" name=\"titre\" id=\"titre_resume\""+(_vm._ssrAttr("value",(_vm.titre)))+"></div></div></div> <div class=\"form-bloc\"><div class=\"col w-full\"><div class=\"col-content\"><label for=\"tps_debut\" id=\"Ltps_debut\">Début</label> <div class=\"relative mt-1\"><div class=\"flex absolute inset-y-0 right-0 items-center pointer-events-none text-activeColor pr-3\">sec</div> <input type=\"text\" name=\"tps_debut\" id=\"tps_debut\""+(_vm._ssrAttr("value",(_vm.tps_debut)))+"></div></div></div></div> <div class=\"form-bloc\"><div class=\"col w-full\"><div class=\"col-content\"><label for=\"tps_fin\" id=\"Ltps_fin\">Fin</label> <div class=\"relative mt-1\"><div class=\"flex absolute inset-y-0 right-0 items-center pointer-events-none text-activeColor pr-3\">sec</div> <input type=\"text\" name=\"tps_fin\" id=\"tps_fin\""+(_vm._ssrAttr("value",(_vm.tps_fin)))+"></div></div></div></div> <div class=\"form-action\"><div><button type=\"button\">Annuler</button></div> <div"+(_vm._ssrStyle(null,null, { display: (_vm.id_tranche != 0) ? '' : 'none' }))+"><button type=\"button\" class=\"bt-delete\">Supprimer</button></div> <div><button type=\"submit\">Enregistrer</button></div></div></form></div></div></div></div></div>")],2)}
var staticRenderFns = []


// CONCATENATED MODULE: ./components/editTranche.vue?vue&type=template&id=97cd3eb8&

// EXTERNAL MODULE: external "vuex"
var external_vuex_ = __webpack_require__(3);

// EXTERNAL MODULE: external "axios"
var external_axios_ = __webpack_require__(6);
var external_axios_default = /*#__PURE__*/__webpack_require__.n(external_axios_);

// EXTERNAL MODULE: external "vuedraggable"
var external_vuedraggable_ = __webpack_require__(12);
var external_vuedraggable_default = /*#__PURE__*/__webpack_require__.n(external_vuedraggable_);

// CONCATENATED MODULE: ./node_modules/babel-loader/lib??ref--2-0!./node_modules/@nuxt/components/dist/loader.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./components/editTranche.vue?vue&type=script&lang=js&
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//



/* harmony default export */ var editTranchevue_type_script_lang_js_ = ({
  name: 'edit-media',
  layout: 'edit',
  middleware: 'auth',
  components: {
    draggable: external_vuedraggable_default.a
  },
  computed: { ...Object(external_vuex_["mapGetters"])(['isAuthenticated', 'loggedInUser'])
  },

  created() {},

  mounted() {
    this.getTranches();
  },

  data() {
    return {
      url_server: this.$store.state.url_server,
      flexIsFile: '',
      source: this.tranche_source,
      id_parent: this.tranche_id_parent,
      id_tranche: 0,
      isNew_tranche: false,
      tranches: [],
      tranche: '',
      isShowLoadingTranches: true,
      isShowNoResultTranches: false,
      titre: '',
      tps_debut: 0,
      tps_fin: 0
    };
  },

  props: {
    tranche_source: String,
    tranche_id_parent: Number
  },
  methods: {
    getTranches: function () {
      this.isShowNoResultTranches = false;
      external_axios_default.a.get(this.url_server + "/getTranches?id_interview=" + this.id_parent).then(response => {
        console.log("getTranches");
        this.isShowLoadingTranches = false;
        this.tranches = response.data.liste;
        console.log("getTranches : " + this.tranches.length);
        if (this.tranches.length == 0) this.isShowNoResultTranches = true;
      }).catch(error => {
        displayErreur('tranches loading error');
      });
    },
    getTranche: function () {
      external_axios_default.a.get(this.url_server + "/getTranche?id_tranche=" + this.id_tranche).then(response => {
        this.tranche = response.data.liste;

        if (typeof this.tranche.titre !== 'undefined') {
          this.titre = this.tranche.titre;
          this.tps_debut = this.tranche.tps_debut.toFixed(2);
          this.tps_fin = this.tranche.tps_fin.toFixed(2);
        } else {
          this.tps_debut = 0;
          this.tps_fin = 0;
        }
      }).catch(error => {
        this.tps_debut = 0;
        this.tps_fin = 0;
        this.id_tranche = 0;
        displayErreur("tranche loading error");
      });
    },
    delTranche: function () {
      external_axios_default.a.get(this.url_server + "/delTranche?id_tranche=" + this.id_tranche).then(response => {
        this.displayTranche();
        this.getTranches();
      }).catch(error => {
        this.id_tranche = 0;
        displayErreur("tranche deleting error");
      });
    },

    submitTrancheForm() {
      var erreur = 'Les champs en rouges sont requis';
      clearRequiredModal();
      this.hideErreur();
      this.isNew_tranche = false;
      if (this.id_tranche == 0) this.isNew_tranche = true;
      let data = {
        id_tranche: this.id_tranche,
        id_interview: this.id_parent,
        titre: this.titre,
        tps_debut: this.tps_debut,
        tps_fin: this.tps_fin,
        isNew: this.isNew_tranche
      };
      var elems = document.querySelectorAll(".modalZone .required_field");
      [].forEach.call(elems, function (el) {
        if (el.value == '') {
          el.classList.add("required");
        }
      });

      if (this.titre == '') {
        document.getElementById("titre_resume").classList.add("required");
      }

      if (this.tps_debut == '') this.tps_debut = 0;

      if (this.tps_debut == 0) {
        document.getElementById("tps_debut").classList.add("required");
      }

      if (this.tps_fin == '') this.tps_fin = 0;

      if (this.tps_fin == 0) {
        document.getElementById("tps_fin").classList.add("required");
      }

      if (checkRequiredModal()) {
        displayErreur(erreur);
      } else {
        disabledActionsModal();
        external_axios_default.a.post(this.url_server + "/addTranche", data).then(response => {
          this.id_tranche = response.data.id_tranche;
          this.isShowNoResultTranche = false;
          this.displayTranche();
          this.tranches = new Array();
          this.getTranches();
        }).catch(error => {
          enabledActionsModal();
          displayErreur("Error adding tranche : " + error);
        });
      }
    },

    isNumber(n) {
      return !isNaN(parseFloat(n)) && isFinite(n);
    },

    displayTranche: function (id_tranche = 0) {
      var _element = document.querySelectorAll("#defaultModal")[0];

      if (_element.classList.contains('hidden')) {
        _element.classList.remove("hidden");

        _element.focus();

        this.id_tranche = id_tranche;

        if (this.id_tranche != 0) {
          this.getTranche();
        } else {
          this.titre = '';
          this.tps_debut = 0;
          this.tps_fin = 0;
          this.id_tranche = 0;
        }
      } else {
        this.id_tranche = 0;
        this.titre = '';
        this.tps_debut = 0;
        this.tps_fin = 0;

        _element.classList.add("hidden");

        this.initForm();
      }
    },
    hideErreur: function () {
      hideErreur();
    },
    initForm: function (event) {
      if (typeof event !== 'undefined') {
        if (event.target.classList.contains("required")) event.target.classList.remove("required");
      } else {
        clearRequiredModal();
      }

      enabledActionsModal();
      hideErreur();
    },

    onEndPosition() {
      let data = {
        id_tranche: this.id_tranche,
        list: this.tranches
      };
      external_axios_default.a.post(this.url_server + "/updateTranchePosition", data).then(response => {}).catch(error => displayErreur("error updating tranches"));
    },

    formatResume(tps_debut, tps_fin) {
      var val = parseFloat(tps_fin).toFixed(2) - parseFloat(tps_debut).toFixed(2);
      return val.toFixed(2).toString().replace(".", ":");
    }

  }
});
// CONCATENATED MODULE: ./components/editTranche.vue?vue&type=script&lang=js&
 /* harmony default export */ var components_editTranchevue_type_script_lang_js_ = (editTranchevue_type_script_lang_js_); 
// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js
var componentNormalizer = __webpack_require__(2);

// CONCATENATED MODULE: ./components/editTranche.vue



function injectStyles (context) {
  
  
}

/* normalize component */

var component = Object(componentNormalizer["a" /* default */])(
  components_editTranchevue_type_script_lang_js_,
  render,
  staticRenderFns,
  false,
  injectStyles,
  null,
  "667f1bce"
  
)

/* harmony default export */ var editTranche = __webpack_exports__["default"] = (component.exports);

/***/ })

};;
//# sourceMappingURL=edit-tranche.js.map