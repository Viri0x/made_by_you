{"version":3,"file":"components/upload.js","sources":["webpack:///./components/upload.vue?a03a","webpack:///./components/upload.vue","webpack:///./components/upload.vue?2a5d","webpack:///./components/upload.vue?5689"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:_vm.cible_class},[_vm._ssrNode(\"<div\"+(_vm._ssrClass(\"justify-between align-center\",_vm.flexIsFile))+\"><label>\"+_vm._ssrEscape(_vm._s(_vm.titre_file))+\"</label> <div class=\\\"previewUpload pb-1 flex items-center justify-center\\\"><div class=\\\"flex items-center justify-center text-sm w-1/2\\\">\"+(_vm._s(_vm.preview))+\"</div></div></div> <label class=\\\"uploadZone bt-upload\\\"><span class=\\\"leading-normal\\\">\"+_vm._ssrEscape(_vm._s(_vm.label_file))+\"</span> <input type=\\\"file\\\" id=\\\"file\\\"\"+(_vm._ssrAttr(\"accept\",_vm.accept_file))+\" class=\\\"hidden\\\"></label> <div class=\\\"progress hidden\\\"><div class=\\\"progress-title\\\">\"+_vm._ssrEscape(_vm._s(_vm.uploadPercentage)+\"%\")+\"</div> <div class=\\\"progress-bar\\\"\"+(_vm._ssrStyle(null,{ width: _vm.uploadPercentage + '%' }, null))+\"></div></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from 'vuex';\nimport axios from 'axios';\n\nexport default {\n  name: 'edit-upload',\n  layout: 'edit',\n  middleware: 'auth',\n  computed: {\n    ...mapGetters(['isAuthenticated', 'loggedInUser']),\n  },\n  created() {\n  }\n  ,\n  mounted() {\n  \tthis.getPreview(this.value_file)\n  },\n  data() {\n    return {\n\t  url_server:this.$store.state.url_server,\n\t  titre_file:this.upload_titre_file,\n\t  label_file:this.upload_label_file,\n\t  accept_file:this.upload_accept_file,\n\t  value_file:this.upload_value_file,\n\t  cible_class:this.upload_cible,\n\t  cible:'.' + this.upload_cible + ' ',\n\t  uploadPercentage: 0,\n\t  file:'',\n\t  preview:'',\n\t  flexIsFile:'',\n    }\n  },\n  props: {\n   upload_titre_file: String,\n   upload_label_file: String,\n   upload_accept_file: String,\n   upload_value_file: String,\n   upload_cible: String,\n  },\n  emits: ['update:specimen_file']\n  ,\n  methods: {\n\thandleFileUpload(e){\n\t\tthis.hideErreur();\n\t\t\n\t\tvar element = e.currentTarget;\n\t\tthis.fileId = element.id;\n\n\t\tthis.file = element.files[0];\n\t\tif (this.file != '') {\n\t\t\tthis.submitFile();\n\t\t}\n\t}\n    ,\n    submitFile(){\n\t  //this.uploadErreur = '';\n\t  this.uploadPercentage = 0;\n\t  let formData = new FormData();\n\t  formData.append('file', this.file);\n\t  document.querySelector(this.cible + \".progress\").classList.remove('hidden');\n\t  document.querySelector(this.cible + \".uploadZone\").classList.add('hidden');\n\t  document.getElementById(\"file\").disabled = true;\n\t  axios.post(this.url_server + '/uploadFile',\n\t    formData,\n\t    {\n\t      headers: {\n\t          'Content-Type': 'multipart/form-data'\n\t      },\n\t      onUploadProgress: function( progressEvent ) {\n\t\t      var val = parseInt( Math.round((progressEvent.loaded*100) / progressEvent.total ));\n\t\t      document.querySelector(this.cible + \".progress-title\").innerHTML = val + '%';\n\t\t\t  this.uploadPercentage = val;\n\t      }.bind(this)\n\t    }\n\t  )\n\t  .then(response => {\n\t\t  \n\t\t  var isOptimize = response.data.isOptimize;\n\t\t  \n\t\t  document.querySelector('#file').value='';\n\t\t  this.value_file = response.data.optimizeFile[0];\n\t\t  this.$emit(\"input\", response.data.optimizeFile[0]);\n\t\t  \n\t\t  if (isOptimize) {\n\t\t\t  document.querySelector(this.cible + \".progress-title\").innerHTML = 'media optimization...';\n\t\t\t  //document.querySelector(this.cible + \".progress-stop\").classList.add('hidden')\n\t\t\t  this.uploadPercentage = 0;\n\t\t\t  \n\t\t\t  setTimeout(function () { \n\t\t\t\t  axios.get(this.url_server + \"/optimizeFile?fichier=\" + this.value_file)\n\t\t\t       .then(response => {\n\t\t\t\t       document.querySelector(this.cible + \".progress-title\").innerHTML = 'media optimization...';\n\t\t\t\t       this.getPreview()\n\t\t\t\t   })\n\t\t\t       .catch(error => displayErreur(\"erreur lors de l'optimisation\"))\n\t\t\t\t  \n\t\t\t  }.bind(this), 2000)\n\t\t\t  \n\t\t  }\n\t\t  else this.getPreview();\n\n\t\t  \n\t\t  \n\t\t  \n      })\n      .catch(err => {\n\t      if (typeof err.response.data.message === 'undefined') displayErreur(err.response.data.message)\n\t      else displayErreur(err.response.data.message)\n\t\t  document.querySelector(this.cible + \".progress\").classList.add('hidden');\n\t\t  document.querySelector(this.cible + \".uploadZone\").classList.remove('hidden');\n\t\t  document.getElementById(\"file\").disabled = false;\n      })\n\t}\n\t,\n\tgetPreview: function()\n    {\n\t    document.querySelector(this.cible + \".progress-title\").innerHTML = '';\n\t    //document.querySelector(this.cible + \".progress-stop\").classList.remove('hidden')\n\t\t\t  \n\t    document.querySelector(this.cible + \".progress\").classList.add('hidden');\n\t\tdocument.querySelector(this.cible + \".uploadZone\").classList.remove('hidden');\n\t\tdocument.getElementById(\"file\").disabled = false;\n\t\t  \n\t    var preview = '';\n\t    var file = this.value_file;\n\t    if (this.value_file != '') {\n\t\t    console.log(\"file : \" + this.value_file)\n\t\t    var ext = file.toLowerCase().split(\".\").pop();\n\t\t    \n\t\t    switch(ext) {\n\t\t\t    case \"mp4\" : preview = '<video width=\"100%\" height=\"auto\" controls><source src=\"/upload/' + file + '\" type=\"video/mp4\"></video>';\n\t\t\t    \t\t\t break;\n\t\t\t    case \"mp3\" : preview = '<audio controls><source src=\"/upload/' + file + '\" type=\"audio/mpeg\"></audio>';\n\t\t\t    \t\t\t break;\n\t\t\t    case \"jpg\" :\n\t\t\t    case \"jpeg\" :\n\t\t\t    case \"gif\" :\n\t\t\t    case \"png\" : preview = '<img class=\"w-20\" src=\"/upload/' + file + '\" />';\n\t\t\t    \t\t\t break;\n\t\t\t    default: preview = '<a class=\"flex\" target=\"blank\" href=\"/upload/' + file + '\"><svg xmlns=\"http://www.w3.org/2000/svg\" class=\"pr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" /><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" /></svg> preview file</a>';\n\t\t\t    \t\t this.flexIsFile = 'flex ';\n\t\t    }\n\t\t    \n\t\t    this.preview = preview;\n\t    }\n\t    \n    }\n\t,\n\thideErreur: function()\n    {\n\t    hideErreur();\n    }\n  }\n}\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./upload.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./upload.vue?vue&type=template&id=5f3b5fe4&\"\nimport script from \"./upload.vue?vue&type=script&lang=js&\"\nexport * from \"./upload.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"25724183\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AAaA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AARA;AAaA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAGA;AAEA;AAMA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAXA;AACA;AAaA;AACA;AAEA;AAEA;AAEA;AACA;AA9GA;AArCA;;AC1BA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}