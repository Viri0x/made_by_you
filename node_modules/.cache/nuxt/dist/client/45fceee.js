(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{419:function(e,t,r){"use strict";r.r(t);r(26),r(19),r(21),r(38),r(20),r(39);var l=r(11),o=(r(66),r(47),r(133),r(9),r(64),r(32)),n=r(65),c=r.n(n);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var f={name:"edit-upload",layout:"edit",middleware:"auth",computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(o.b)(["isAuthenticated","loggedInUser"])),created:function(){},mounted:function(){this.getPreview(this.value_file)},data:function(){return{url_server:this.$store.state.url_server,titre_file:this.upload_titre_file,label_file:this.upload_label_file,accept_file:this.upload_accept_file,value_file:this.upload_value_file,cible_class:this.upload_cible,cible:"."+this.upload_cible+" ",uploadPercentage:0,file:"",preview:"",flexIsFile:""}},props:{upload_titre_file:String,upload_label_file:String,upload_accept_file:String,upload_value_file:String,upload_cible:String},emits:["update:specimen_file"],methods:{handleFileUpload:function(e){this.hideErreur();var element=e.currentTarget;this.fileId=element.id,this.file=element.files[0],""!=this.file&&this.submitFile()},submitFile:function(){var e=this;this.uploadPercentage=0;var t=new FormData;t.append("file",this.file),document.querySelector(this.cible+".progress").classList.remove("hidden"),document.querySelector(this.cible+".uploadZone").classList.add("hidden"),document.getElementById("file").disabled=!0,c.a.post(this.url_server+"/uploadFile",t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=parseInt(Math.round(100*e.loaded/e.total));document.querySelector(this.cible+".progress-title").innerHTML=t+"%",this.uploadPercentage=t}.bind(this)}).then((function(t){var r=t.data.isOptimize;document.querySelector("#file").value="",e.value_file=t.data.optimizeFile[0],e.$emit("input",t.data.optimizeFile[0]),r?(document.querySelector(e.cible+".progress-title").innerHTML="media optimization...",e.uploadPercentage=0,setTimeout(function(){var e=this;c.a.get(this.url_server+"/optimizeFile?fichier="+this.value_file).then((function(t){document.querySelector(e.cible+".progress-title").innerHTML="media optimization...",e.getPreview()})).catch((function(e){return displayErreur("erreur lors de l'optimisation")}))}.bind(e),2e3)):e.getPreview()})).catch((function(t){t.response.data.message,displayErreur(t.response.data.message),document.querySelector(e.cible+".progress").classList.add("hidden"),document.querySelector(e.cible+".uploadZone").classList.remove("hidden"),document.getElementById("file").disabled=!1}))},getPreview:function(){document.querySelector(this.cible+".progress-title").innerHTML="",document.querySelector(this.cible+".progress").classList.add("hidden"),document.querySelector(this.cible+".uploadZone").classList.remove("hidden"),document.getElementById("file").disabled=!1;var e="",t=this.value_file;if(""!=this.value_file){switch(console.log("file : "+this.value_file),t.toLowerCase().split(".").pop()){case"mp4":e='<video width="100%" height="auto" controls><source src="/upload/'+t+'" type="video/mp4"></video>';break;case"mp3":e='<audio controls><source src="/upload/'+t+'" type="audio/mpeg"></audio>';break;case"jpg":case"jpeg":case"gif":case"png":e='<img class="w-20" src="/upload/'+t+'" />';break;default:e='<a class="flex" target="blank" href="/upload/'+t+'"><svg xmlns="http://www.w3.org/2000/svg" class="pr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg> preview file</a>',this.flexIsFile="flex "}this.preview=e}},hideErreur:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){hideErreur()}))}},h=f,v=r(10),component=Object(v.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.cible_class},[r("div",{staticClass:"justify-between align-center",class:e.flexIsFile},[r("label",[e._v(e._s(e.titre_file))]),e._v(" "),r("div",{staticClass:"previewUpload pb-1 flex items-center justify-center"},[r("div",{staticClass:"flex items-center justify-center text-sm w-1/2",domProps:{innerHTML:e._s(e.preview)}})])]),e._v(" "),r("label",{staticClass:"uploadZone bt-upload",on:{click:function(t){return e.hideErreur()}}},[r("span",{staticClass:"leading-normal"},[e._v(e._s(e.label_file))]),e._v(" "),r("input",{ref:"file",staticClass:"hidden",attrs:{type:"file",id:"file",accept:e.accept_file},on:{change:function(t){return e.handleFileUpload(t)}}})]),e._v(" "),r("div",{staticClass:"progress hidden"},[r("div",{staticClass:"progress-title"},[e._v(e._s(e.uploadPercentage)+"%")]),e._v(" "),r("div",{staticClass:"progress-bar",style:{width:e.uploadPercentage+"%"}})])])}),[],!1,null,null,null);t.default=component.exports}}]);